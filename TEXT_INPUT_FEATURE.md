# –§—É–Ω–∫—Ü–∏—è —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –≤–≤–æ–¥–∞ –∏–º–µ–Ω–∏ –≤–º–µ—Å—Ç–æ –ø–∞—Å–ø–æ—Ä—Ç–∞

## –û–ø–∏—Å–∞–Ω–∏–µ

–¢–µ–ø–µ—Ä—å –º–µ–Ω–µ–¥–∂–µ—Ä—ã –º–æ–≥—É—Ç –≤–≤–æ–¥–∏—Ç—å –∏–º—è –∏ —Ñ–∞–º–∏–ª–∏—é –ø–∞–ª–æ–º–Ω–∏–∫–∞ **—Ç–µ–∫—Å—Ç–æ–º** –≤–º–µ—Å—Ç–æ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–∞—Å–ø–æ—Ä—Ç–∞.

## –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### 1. –ù–∞—á–∞—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
- –ù–∞–∂–∞—Ç—å "–°–æ–∑–¥–∞—Ç—å –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ"
- –í–≤–µ—Å—Ç–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞–ª–æ–º–Ω–∏–∫–æ–≤

### 2. –í—ã–±—Ä–∞—Ç—å —Å–ø–æ—Å–æ–± –≤–≤–æ–¥–∞ –¥–∞–Ω–Ω—ã—Ö

**–í–∞—Ä–∏–∞–Ω—Ç –ê: –ó–∞–≥—Ä—É–∑–∏—Ç—å –ø–∞—Å–ø–æ—Ä—Ç (–∫–∞–∫ —Ä–∞–Ω—å—à–µ)**
- –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ –∏–ª–∏ PDF –ø–∞—Å–ø–æ—Ä—Ç–∞
- –ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–µ—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ OCR

**–í–∞—Ä–∏–∞–Ω—Ç –ë: –ù–∞–ø–∏—Å–∞—Ç—å –∏–º—è —Ç–µ–∫—Å—Ç–æ–º (–ù–û–í–ê–Ø –§–£–ù–ö–¶–ò–Ø)**
- –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ–∫—Å—Ç–æ–º: `–§–ê–ú–ò–õ–ò–Ø –ò–ú–Ø`
- –ù–∞–ø—Ä–∏–º–µ—Ä: `IVANOV IVAN`
- –ë–æ—Ç –ø–æ–∫–∞–∂–µ—Ç –∫–Ω–æ–ø–∫–∏ –≤—ã–±–æ—Ä–∞ –ø–æ–ª–∞:
  - üë® –ú—É–∂—Å–∫–æ–π (M)
  - üë© –ñ–µ–Ω—Å–∫–∏–π (F)
- –ü–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ –ø–æ–ª–∞ –ø–æ–ø—Ä–æ—Å–∏—Ç —Å–ª–µ–¥—É—é—â–∏–π –ø–∞—Å–ø–æ—Ä—Ç

### 3. –ó–∞–ø–æ–ª–Ω–∏—Ç—å —Ñ–æ—Ä–º—É
- –ü–æ—Å–ª–µ –≤—Å–µ—Ö –ø–∞–ª–æ–º–Ω–∏–∫–æ–≤ –æ—Ç–∫—Ä–æ–µ—Ç—Å—è —Ñ–æ—Ä–º–∞
- –î–ª—è –ø–∞–ª–æ–º–Ω–∏–∫–æ–≤ –±–µ–∑ –ø–∞—Å–ø–æ—Ä—Ç–∞ –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –≤—Ä—É—á–Ω—É—é –∑–∞–ø–æ–ª–Ω–∏—Ç—å:
  - –î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è
  - –ù–æ–º–µ—Ä –ø–∞—Å–ø–æ—Ä—Ç–∞
  - –ò–ò–ù (–µ—Å–ª–∏ –Ω—É–∂–µ–Ω)

## –ü—Ä–∏–º–µ—Ä—ã

### –ü—Ä–∏–º–µ—Ä 1: –û–¥–∏–Ω –ø–∞–ª–æ–º–Ω–∏–∫ –±–µ–∑ –ø–∞—Å–ø–æ—Ä—Ç–∞
```
–ë–æ—Ç: "–û—Ç–ø—Ä–∞–≤—å—Ç–µ –ø–∞—Å–ø–æ—Ä—Ç 1-–≥–æ –ø–∞–ª–æ–º–Ω–∏–∫–∞"
–ú–µ–Ω–µ–¥–∂–µ—Ä: IVANOV IVAN
–ë–æ—Ç: "‚úÖ –ü—Ä–∏–Ω—è—Ç–æ: IVANOV IVAN
      –í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª:"
      [üë® –ú—É–∂—Å–∫–æ–π (M)] [üë© –ñ–µ–Ω—Å–∫–∏–π (F)]
–ú–µ–Ω–µ–¥–∂–µ—Ä: [–Ω–∞–∂–∏–º–∞–µ—Ç üë® –ú—É–∂—Å–∫–æ–π]
–ë–æ—Ç: "‚úÖ –ü—Ä–∏–Ω—è—Ç–æ: IVANOV IVAN
      üë® –ü–æ–ª: –ú—É–∂—Å–∫–æ–π"
```

### –ü—Ä–∏–º–µ—Ä 2: –ì—Ä—É–ø–ø–∞ - –æ–¥–∏–Ω —Å –ø–∞—Å–ø–æ—Ä—Ç–æ–º, –æ–¥–∏–Ω –±–µ–∑
```
–ë–æ—Ç: "–°–∫–æ–ª—å–∫–æ –ø–∞–ª–æ–º–Ω–∏–∫–æ–≤?"
–ú–µ–Ω–µ–¥–∂–µ—Ä: 2

–ë–æ—Ç: "–û—Ç–ø—Ä–∞–≤—å—Ç–µ –ø–∞—Å–ø–æ—Ä—Ç 1-–≥–æ –ø–∞–ª–æ–º–Ω–∏–∫–∞"
–ú–µ–Ω–µ–¥–∂–µ—Ä: [–æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ñ–æ—Ç–æ –ø–∞—Å–ø–æ—Ä—Ç–∞]
–ë–æ—Ç: "‚úÖ –†–∞—Å–ø–æ–∑–Ω–∞–Ω–æ: PETROV PETR... –ü–∞—Å–ø–æ—Ä—Ç 2-–≥–æ –ø–∞–ª–æ–º–Ω–∏–∫–∞:"

–ú–µ–Ω–µ–¥–∂–µ—Ä: SIDOROV SERGEY
–ë–æ—Ç: "‚úÖ –ü—Ä–∏–Ω—è—Ç–æ: SIDOROV SERGEY
      –í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª:"
      [üë® –ú—É–∂—Å–∫–æ–π (M)] [üë© –ñ–µ–Ω—Å–∫–∏–π (F)]
–ú–µ–Ω–µ–¥–∂–µ—Ä: [–Ω–∞–∂–∏–º–∞–µ—Ç üë® –ú—É–∂—Å–∫–æ–π]
–ë–æ—Ç: "‚úÖ –ü—Ä–∏–Ω—è—Ç–æ: SIDOROV SERGEY
      üë® –ü–æ–ª: –ú—É–∂—Å–∫–æ–π"
     [–û—Ç–∫—Ä—ã–≤–∞–µ—Ç —Ñ–æ—Ä–º—É]
```

### –ü—Ä–∏–º–µ—Ä 3: –ò–º—è —Å –æ—Ç—á–µ—Å—Ç–≤–æ–º –∏ –∂–µ–Ω—Å–∫–∏–π –ø–æ–ª
```
–ú–µ–Ω–µ–¥–∂–µ—Ä: KUANBAEVA RAYA ALTYBAEVNA
–ë–æ—Ç: "‚úÖ –ü—Ä–∏–Ω—è—Ç–æ: KUANBAEVA RAYA ALTYBAEVNA
      –í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª:"
      [üë® –ú—É–∂—Å–∫–æ–π (M)] [üë© –ñ–µ–Ω—Å–∫–∏–π (F)]
–ú–µ–Ω–µ–¥–∂–µ—Ä: [–Ω–∞–∂–∏–º–∞–µ—Ç üë© –ñ–µ–Ω—Å–∫–∏–π]
–ë–æ—Ç: "‚úÖ –ü—Ä–∏–Ω—è—Ç–æ: KUANBAEVA RAYA ALTYBAEVNA
      üë© –ü–æ–ª: –ñ–µ–Ω—Å–∫–∏–π"
```

## –§–æ—Ä–º–∞—Ç –≤–≤–æ–¥–∞

### –ü—Ä–∞–≤–∏–ª—å–Ω–æ ‚úÖ
- `IVANOV IVAN`
- `PETROV PETR IVANOVICH`
- `ivanov ivan` (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–≤–µ–¥–µ—Ç—Å—è –≤ IVANOV IVAN)
- `  SMITH  JOHN  ` (–ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã —É–¥–∞–ª—è—Ç—Å—è)

### –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ ‚ùå
- `IVANOV` (—Ç–æ–ª—å–∫–æ —Ñ–∞–º–∏–ª–∏—è, –Ω–µ—Ç –∏–º–µ–Ω–∏)
- `I` (—Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–æ–µ)

### –ï—Å–ª–∏ –≤–≤–æ–¥ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
–ë–æ—Ç –ø–æ–∫–∞–∂–µ—Ç:
```
‚ùå –í–≤–µ–¥–∏—Ç–µ –§–∞–º–∏–ª–∏—é –∏ –ò–º—è —á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª

–ù–∞–ø—Ä–∏–º–µ—Ä: IVANOV IVAN

–ò–ª–∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ —Ñ–æ—Ç–æ/—Å–∫–∞–Ω –ø–∞—Å–ø–æ—Ä—Ç–∞
```

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ß—Ç–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

–î–ª—è –ø–∞–ª–æ–º–Ω–∏–∫–æ–≤, –≤–≤–µ–¥–µ–Ω–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–º:
- `Last Name`: –í–≤–µ–¥–µ–Ω–Ω–∞—è —Ñ–∞–º–∏–ª–∏—è (–≤ –≤–µ—Ä—Ö–Ω–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ)
- `First Name`: –í–≤–µ–¥–µ–Ω–Ω–æ–µ –∏–º—è (–≤ –≤–µ—Ä—Ö–Ω–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ)
- `Gender`: –í—ã–±—Ä–∞–Ω–Ω—ã–π –ø–æ–ª (`M` - –º—É–∂—Å–∫–æ–π, `F` - –∂–µ–Ω—Å–∫–∏–π)
- `Date of Birth`: `-` (–∑–∞–ø–æ–ª–Ω–∏—Ç—å –≤ —Ñ–æ—Ä–º–µ)
- `Document Number`: `-` (–∑–∞–ø–æ–ª–Ω–∏—Ç—å –≤ —Ñ–æ—Ä–º–µ)
- `IIN`: `-` (–∑–∞–ø–æ–ª–Ω–∏—Ç—å –≤ —Ñ–æ—Ä–º–µ)
- `passport_image_path`: `None` (–ø–∞—Å–ø–æ—Ä—Ç –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω)

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç—É —Ñ—É–Ω–∫—Ü–∏—é

1. **–ü–∞—Å–ø–æ—Ä—Ç –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω** - –∫–ª–∏–µ–Ω—Ç –ø–æ–∫–∞ –Ω–µ –ø—Ä–∏—Å–ª–∞–ª —Å–∫–∞–Ω
2. **–ë—ã—Å—Ç—Ä–æ–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ** - –Ω—É–∂–Ω–æ —Å—Ä–æ—á–Ω–æ –∑–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –º–µ—Å—Ç–æ
3. **–ü—Ä–æ–±–ª–µ–º—ã —Å OCR** - –ø–∞—Å–ø–æ—Ä—Ç –ø–ª–æ—Ö–æ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞ –∏ OCR –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
4. **ID –∫–∞—Ä—Ç—ã** - –≤–º–µ—Å—Ç–æ –ø–∞—Å–ø–æ—Ä—Ç–∞ —Ç–æ–ª—å–∫–æ —É–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏–µ –ª–∏—á–Ω–æ—Å—Ç–∏

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

‚ö†Ô∏è –ú–µ–Ω–µ–¥–∂–µ—Ä –¥–æ–ª–∂–µ–Ω –±—É–¥–µ—Ç –≤—Ä—É—á–Ω—É—é –∑–∞–ø–æ–ª–Ω–∏—Ç—å –≤ —Ñ–æ—Ä–º–µ:
- –î–∞—Ç—É —Ä–æ–∂–¥–µ–Ω–∏—è
- –ù–æ–º–µ—Ä –ø–∞—Å–ø–æ—Ä—Ç–∞
- –ò–ò–ù (–µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è)
- –°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è –ø–∞—Å–ø–æ—Ä—Ç–∞

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

‚úÖ –ë—ã—Å—Ç—Ä–µ–µ - –Ω–µ –Ω—É–∂–Ω–æ –∂–¥–∞—Ç—å OCR (30 —Å–µ–∫—É–Ω–¥)
‚úÖ –ù–∞–¥–µ–∂–Ω–µ–µ - –Ω–µ—Ç –æ—à–∏–±–æ–∫ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è
‚úÖ –ì–∏–±—á–µ - –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –±—Ä–æ–Ω—å –¥–æ –ø–æ–ª—É—á–µ–Ω–∏—è –ø–∞—Å–ø–æ—Ä—Ç–∞
‚úÖ –ü—Ä–æ—â–µ - –ø—Ä–∏ –ø–ª–æ—Ö–æ–º –∫–∞—á–µ—Å—Ç–≤–µ —Å–∫–∞–Ω–∞

## –ö–æ–¥

–§–∞–π–ª: `bull_project/bull_bot/handlers/booking_handlers.py`
–§—É–Ω–∫—Ü–∏—è: `process_passport_text()` (—Å—Ç—Ä–æ–∫–∞ 299)

```python
@router.message(BookingFlow.waiting_passport, F.text)
async def process_passport_text(message: Message, state: FSMContext):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –≤–≤–æ–¥–∞ –∏–º–µ–Ω–∏ –≤–º–µ—Å—Ç–æ –ø–∞—Å–ø–æ—Ä—Ç–∞"""
    # –ü–∞—Ä—Å–∏–º —Ñ–∞–º–∏–ª–∏—é –∏ –∏–º—è
    parts = message.text.strip().split()
    if len(parts) < 2:
        await message.answer("‚ùå –í–≤–µ–¥–∏—Ç–µ –§–∞–º–∏–ª–∏—é –∏ –ò–º—è —á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª...")
        return

    last_name = parts[0].upper()
    first_name = " ".join(parts[1:]).upper()

    # –°–æ–∑–¥–∞–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö
    p_data = {...}

    await next_step_pilgrim(message, state, p_data)
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç:
```bash
python3 test_text_input.py
```

–†–µ–∑—É–ª—å—Ç–∞—Ç –¥–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑–∞—Ç—å —É—Å–ø–µ—à–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å–ª—É—á–∞–µ–≤.

## –†–∞–∑–≤–∏—Ç–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ (–±—É–¥—É—â–µ–µ)

–í —Å–ª–µ–¥—É—é—â–∏—Ö –≤–µ—Ä—Å–∏—è—Ö –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å:
1. –ö–Ω–æ–ø–∫–∞ "–ó–∞–≥—Ä—É–∑–∏—Ç—å –ø–∞—Å–ø–æ—Ä—Ç –ø–æ–∑–∂–µ" –¥–ª—è —É–∂–µ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –±—Ä–æ–Ω–µ–π
2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–ª–∞ –ø–æ –∏–º–µ–Ω–∏ (API)
3. –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ –¥–∞—Ç—ã —Ä–æ–∂–¥–µ–Ω–∏—è –ø—Ä—è–º–æ –≤ —á–∞—Ç–µ
4. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ "–§–∞–º–∏–ª–∏—è, –ò–º—è" (—Å –∑–∞–ø—è—Ç–æ–π)
